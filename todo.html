<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Just To Do it!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="todo.css" />
    <!-- <script src="main.js"></script> -->
</head>
<body>
    <!-- Goal here is to parse a todo.txt file and create Todo list
    save to local storage. -->
    
    <div id="todoList">
        <div id="title">Just To Do It!</div>
        <ul id="todos">
        </ul>
        <div id="add">
            <label for="addInput">Add a Todo</label>
            <input type="text" name="addInput" id="addInput">
        </div>
    </div>
    <script>

        document.addEventListener('DOMContentLoaded',e=>{
            document.getElementById("addInput").addEventListener('keypress',ev=>{
                if(ev.key === "Enter") {
                    let inputEl = document.getElementById("addInput");
                    handleAdd(inputEl.value);
                    inputEl.value = "";
                }
            })
        });

        //Handler for adding an item.
        function handleAdd(t) {

            let td = {done:false,text:t}

            addNewItem(td);
            addToStorage(td);
        }

        /* 
            Fluency: DOM manipulation

            This code shows an example of creating elements and injecting them into 
            the DOM, 
        */
        function addNewItem(todoObject) {
            //Create Elements
            var li = document.createElement("li");
            var check = document.createElement("input");
            check.setAttribute("type","checkbox");

            if(todoObject.done === true) {
                check.setAttribute("checked",true);
            }

            var label = document.createElement("label");
            label.innerHTML = todoObject.text;

            //Append Elements to list item.
            li.appendChild(check);
            li.appendChild(label);
            document.querySelector("ul#todos").appendChild(li);
        }


        /* 
            Fluency: localStorage

            This code shows a real-life, working example of localstorage.
            Fetching, parsing, writing, and saving to localstorage of objects.
        */

        function addToStorage(todoObject){
            //Get local storage
            let todosLS = window.localStorage.getItem("todos")
            //Make sure it exists.
            let todos = (todosLS !== null) ? JSON.parse(todosLS) : [];

            //Add object
            todos.push(todoObject);

            //Save to local storage.
            window.localStorage.setItem("todos",JSON.stringify(todos));
        }


    </script>
</body>
</html>
